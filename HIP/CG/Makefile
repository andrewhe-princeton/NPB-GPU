SHELL=/bin/sh

CLASS=S
BENCHMARK=cg
BENCHMARKU=CG
PARAMETERS=setparams

include ../config/make.def

ifeq ($(HIP_PLATFORM),amd)
	COMPILER_FLAGS = $(AMD_FLAGS)
else ifeq ($(HIP_PLATFORM),nvidia)
	COMPILER_FLAGS = $(NVIDIA_FLAGS)
else ifeq ($(HIP_PLATFORM),intel)
	COMPILER_FLAGS = $(INTEL_FLAGS)
else
    COMPILER_FLAGS = $(AMD_FLAGS)
endif

COMPILE_CG=$(CC) $(COMPILER_FLAGS) $(BENCHMARK).cpp -DCLASS_$(CLASS) -o $(BENCHMARK).$(CLASS)
SET_PARAMETERS=$(CC) $(SYSDIR)/$(PARAMETERS).cpp -o $(PARAMETERS) && ./$(PARAMETERS) $(BENCHMARK) $(CLASS)
MOVE_BINARIES=mv $(BENCHMARK).$(CLASS) $(BINDIR) && mv $(PARAMETERS) $(SYSDIR)

$(BENCHMARK):
	$(pwd) $(SET_PARAMETERS) && $(COMPILE_CG) && $(MOVE_BINARIES)

clean:
	- rm -f *.o *~ 
	- rm -f npbparams.hpp core
